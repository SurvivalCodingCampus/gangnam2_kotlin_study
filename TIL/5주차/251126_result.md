## Result 패턴

### Result 패턴이란?

> 성공 / 실패 결과를 값 형태로 표현하여, 예외 중심이 아닌 흐름 중심으로 처리할 수 있도록 도와주는 패턴

#### 기존 방식 ❌ — 예외 기반 흐름

```kotlin
val data = api.getUser() // 실패 시 앱 크래시 위험
updateUI(data)
```

#### Result 패턴 방식 ⭕ — 성공/실패를 명시적으로 처리

```kotlin
when (val result = repository.getUser(id)) {
    is Result.Success -> showUser(result.data)
    is Result.Error -> showError(result.error)
}
```

- **앱이 절대 죽지 않는다 → 안정성과 가독성이 향상됨**

### Result 구조

```kotlin
sealed class Result<T, E> {
    data class Success<T>(val data: T) : Result<T, Nothing>()
    data class Error<E>(val error: E) : Result<Nothing, E>()
}
```

| 요소  | 의미              |
|-----|-----------------|
| `T` | 성공 시 전달되는 데이터   |
| `E` | 실패 시 전달되는 오류 정보 |

- 두 흐름을 **컴파일 타임**에 확실히 나눌 수 있음

### NetworkError — 오류를 도메인에서 통제

```kotlin
sealed class NetworkError {
    object NetworkUnavailable : NetworkError()
    object Timeout : NetworkError()
    object ParseError : NetworkError()
    data class HttpError(val code: Int) : NetworkError()
    data class Unknown(val message: String) : NetworkError()
}
```

- **UI에서 어떤 오류인지 한눈에 판단 가능**
- 오류 메시지도 쉽게 매핑 가능 (UI에서 활용할 수 있음)

```kotlin
fun NetworkError.toMessage(): String = when (this) {
    NetworkError.NetworkUnavailable -> "네트워크를 확인해주세요."
    NetworkError.Timeout -> "요청 시간이 초과되었습니다."
    is NetworkError.HttpError -> "서버 오류(${code})가 발생했습니다."
    NetworkError.ParseError -> "데이터 파싱 오류"
    is NetworkError.Unknown -> message
}
```

### Layer별 책임 분리

| Layer      | 역할                      | 리턴 타입                         |
|------------|-------------------------|-------------------------------|
| DataSource | **순수 HTTP 통신 + DTO 받기** | `Response<DTO>`               |
| Repository | DTO → Model 변환 / 실패 처리  | `Result<Model, NetworkError>` |
| ViewModel  | UI State 변환             | StateFlow/UI State            |

- 테스트도 Layer 단위로 가능
- UI를  **Result** 기반으로 동작 → 안정적

#### Result 패턴 장점

장점

---

앱 안정성 증가 (Crash 방지)

---

실패 처리를 강제함 (when exhaustive)

---

비즈니스 로직 분리 → 유지보수 용이

---

테스트 가능한 구조

---

UI State 변환 쉬움

---

> “앱 안전성, 유지보수성, 테스트 확장성”
